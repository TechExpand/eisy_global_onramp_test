// src/loader.ts
var scriptLoadingStatus = {
  isLoading: false,
  isLoaded: false,
  startTime: 0
};
async function loadMoonPay(version = "v1") {
  return new Promise((resolve, reject) => {
    const scriptSrc = `https://static.moonpay.com/web-sdk/${version}/moonpay-web-sdk.min.js`;
    const existingScript = document.querySelector(`script[src="${scriptSrc}"]`);
    if (existingScript) {
      if (scriptLoadingStatus.isLoaded) {
        resolve(window.MoonPayWebSdk?.init);
      } else if (scriptLoadingStatus.isLoading) {
        const elapsedTime = Date.now() - scriptLoadingStatus.startTime;
        if (elapsedTime > 1e4) {
          reject(new Error("Loading MoonPayWebSdk script timed out."));
        } else {
          setTimeout(() => resolve(loadMoonPay(version)), 100);
        }
      }
      return;
    }
    scriptLoadingStatus.isLoading = true;
    scriptLoadingStatus.startTime = Date.now();
    const script = document.createElement("script");
    script.async = true;
    script.src = scriptSrc;
    script.addEventListener("load", () => {
      scriptLoadingStatus.isLoading = false;
      scriptLoadingStatus.isLoaded = true;
      resolve(window.MoonPayWebSdk?.init);
    });
    script.addEventListener("error", () => {
      scriptLoadingStatus.isLoading = false;
      scriptLoadingStatus.isLoaded = false;
      reject(new Error("Failed to load MoonPayWebSdk script."));
    });
    document.body.appendChild(script);
  });
}
export {
  loadMoonPay
};
//# sourceMappingURL=index.js.map